(()=>{var e={};e.id=884,e.ids=[884],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},821:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=t(260),a=t(8203),l=t(5155),o=t.n(l),i=t(7292),n={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);t.d(s,n);let c=["",{children:["pools",{children:["create-pool",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5315)),"X:\\Web Devlopment\\SubSplitter\\Frontend\\src\\app\\pools\\create-pool\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,1354)),"X:\\Web Devlopment\\SubSplitter\\Frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["X:\\Web Devlopment\\SubSplitter\\Frontend\\src\\app\\pools\\create-pool\\page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/pools/create-pool/page",pathname:"/pools/create-pool",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1424:(e,s,t)=>{Promise.resolve().then(t.bind(t,5315))},1152:(e,s,t)=>{Promise.resolve().then(t.bind(t,4151))},4849:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(1680).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6201:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(1680).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},6235:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(1680).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8741:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(1680).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4151:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(5512),a=t(8009),l=t(6095),o=t.n(l),i=t(5103),n=t(9621);let c=(0,t(1680).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var d=t(4849),m=t(6235),p=t(8741),u=t(6201),h=t(9334),x=t(5402);let g=()=>{let e=(0,h.useRouter)(),[s,t]=(0,a.useState)(null),[l,g]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[f,j]=(0,a.useState)(0),[y,N]=(0,a.useState)(2),[w,P]=(0,a.useState)({email:"",password:""}),[S,C]=(0,a.useState)([]),[k,A]=(0,a.useState)(!0),[$,E]=(0,a.useState)(!1),[F,I]=(0,a.useState)(null),[U,M]=(0,a.useState)(1),_=y>0?parseFloat((f/y).toFixed(2)):0,T=y>1?Math.round((f-_)/f*100):0;(0,a.useEffect)(()=>{(async()=>{try{A(!0);let e=await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api"}/subscription-services`);if(!e.ok)throw Error(`Failed to fetch services: ${e.status}`);let s=(await e.json()).map(e=>({id:e.serviceId,name:e.name,logo:e.logoUrl||"/assets/logos/default.svg",color:e.color||"#6366f1",plans:e.plans?e.plans.map(e=>({id:e.planId,name:e.name,price:parseFloat(e.price)})):[]}));C(s)}catch(e){console.error("Error fetching services:",e),I("Failed to load available services. Please try again later.")}finally{A(!1)}})()},[]);let z=e=>{t(e),g(""),v(""),j(0),e.plans&&0!==e.plans.length||M(2)},q=(e,s)=>{g(e),j(s),M(2)},B=async t=>{if(t.preventDefault(),!s){I("Please select a service");return}if(f<=0){I("Please enter a valid total cost");return}if(y<2){I("Pool capacity must be at least 2");return}if(""===w.email.trim()||""===w.password.trim()){I("Please provide valid credentials");return}try{E(!0),I(null);let t=JSON.stringify(w),r={serviceId:s.id,name:s.name+("custom"===l?` (${b})`:""),encryptedCredentials:t,slotsTotal:y,costPerSlot:_};await x.U.createPool(r),e.push("/pools")}catch(e){console.error("Error creating pool:",e),I("Failed to create pool. Please try again later."),E(!1)}};return(0,r.jsxs)(n.A,{children:[(0,r.jsx)(o(),{children:(0,r.jsx)("title",{children:"Create Subscription Pool | SubSplitter"})}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("button",{onClick:()=>e.push("/pools"),className:"text-gray-400 hover:text-white flex items-center mb-4",children:[(0,r.jsx)(c,{size:18,className:"mr-2"}),"Back to Pools"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold mb-1",children:"Create New Subscription Pool"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Split the cost of your subscription with others"})]}),(0,r.jsxs)("div",{className:"flex mb-8",children:[(0,r.jsxs)("div",{className:`flex items-center ${U>=1?"text-purple-500":"text-gray-500"}`,children:[(0,r.jsx)("div",{className:`flex items-center justify-center w-8 h-8 rounded-full mr-2 ${U>=1?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"}`,children:U>1?(0,r.jsx)(d.A,{size:16}):1}),(0,r.jsx)("span",{className:"mr-4",children:"Select Service"})]}),(0,r.jsx)("div",{className:`h-0.5 flex-grow my-auto mx-2 ${U>=2?"bg-purple-500":"bg-gray-700"}`}),(0,r.jsxs)("div",{className:`flex items-center ${U>=2?"text-purple-500":"text-gray-500"}`,children:[(0,r.jsx)("div",{className:`flex items-center justify-center w-8 h-8 rounded-full mr-2 ${U>=2?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"}`,children:U>2?(0,r.jsx)(d.A,{size:16}):2}),(0,r.jsx)("span",{className:"mr-4",children:"Configure Pool"})]}),(0,r.jsx)("div",{className:`h-0.5 flex-grow my-auto mx-2 ${U>=3?"bg-purple-500":"bg-gray-700"}`}),(0,r.jsxs)("div",{className:`flex items-center ${U>=3?"text-purple-500":"text-gray-500"}`,children:[(0,r.jsx)("div",{className:`flex items-center justify-center w-8 h-8 rounded-full mr-2 ${U>=3?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"}`,children:"3"}),(0,r.jsx)("span",{children:"Review & Create"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6",children:[k&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(m.A,{size:36,className:"animate-spin mx-auto text-purple-500 mb-4"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Loading available services..."})]}),F&&(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 mb-6 text-red-400",children:(0,r.jsx)("p",{children:F})}),!k&&(0,r.jsxs)("form",{onSubmit:B,children:[1===U&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Select a subscription service"}),0===S.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-400",children:(0,r.jsx)("p",{children:"No services available. Please try again later."})}):(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[S.map(e=>(0,r.jsx)("div",{onClick:()=>z(e),className:`p-4 rounded-lg cursor-pointer transition-all border ${s?.id===e.id?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50 hover:bg-gray-700"}`,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-12 w-12 relative rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",children:(0,r.jsx)(i.default,{src:e.logo,alt:e.name,layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("h3",{className:"font-medium",children:e.name})})]})},e.id)),(0,r.jsxs)("div",{onClick:()=>{t({id:"custom",name:"Custom Service",logo:"/assets/logos/default.svg",color:"#6d28d9"}),M(2)},className:`p-4 rounded-lg cursor-pointer transition-all border ${s?.id==="custom"?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50 hover:bg-gray-700"} flex items-center justify-center`,children:[(0,r.jsx)(p.A,{size:20,className:"mr-2 text-purple-500"}),(0,r.jsx)("span",{children:"Custom Service"})]})]}),s&&s.plans&&s.plans.length>0&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium mb-4",children:["Select a plan for ",s.name]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[s.plans.map(e=>(0,r.jsxs)("div",{onClick:()=>q(e.id,e.price),className:`p-4 rounded-lg cursor-pointer transition-all border ${l===e.id?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50 hover:bg-gray-700"}`,children:[(0,r.jsx)("h4",{className:"font-medium mb-1",children:e.name}),(0,r.jsxs)("p",{className:"text-gray-400",children:["$",e.price.toFixed(2),"/month"]})]},e.id)),(0,r.jsxs)("div",{className:`p-4 rounded-lg transition-all border ${"custom"===l?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50"}`,children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Custom Plan"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Plan name",className:"w-full bg-gray-900 border border-gray-700 rounded p-2 text-sm",value:b,onChange:e=>v(e.target.value)}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"$"}),(0,r.jsx)("input",{type:"number",min:"0.01",step:"0.01",placeholder:"Monthly cost",className:"flex-1 bg-gray-900 border border-gray-700 rounded p-2 text-sm",value:f||"",onChange:e=>j(parseFloat(e.target.value)||0)}),(0,r.jsx)("span",{className:"ml-1",children:"/month"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{if(""===b.trim()||f<=0){I("Please provide a valid plan name and cost");return}g("custom"),M(2),I(null)},className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-1 px-3 rounded text-sm transition duration-200",children:"Use Custom Plan"})]})]})]})]}),s&&(!s.plans||0===s.plans.length)&&(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{type:"button",onClick:()=>M(2),className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",children:"Continue"})})]}),2===U&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Configure your subscription pool"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"h-12 w-12 relative rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",style:{backgroundColor:s?.color||"#374151"},children:(0,r.jsx)(i.default,{src:s?.logo||"/assets/logos/default.svg",alt:s?.name||"Custom Service",layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"font-medium",children:s?.name||"Custom Service"}),l&&"custom"!==l&&s?.plans&&(0,r.jsx)("p",{className:"text-sm text-gray-400",children:s.plans.find(e=>e.id===l)?.name}),"custom"===l&&(0,r.jsx)("p",{className:"text-sm text-gray-400",children:b})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Total Monthly Cost"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2 text-gray-400",children:"$"}),(0,r.jsx)("input",{type:"number",min:"0.01",step:"0.01",placeholder:"0.00",className:"flex-1 bg-gray-700 border border-gray-600 rounded-md p-2.5",value:f||"",onChange:e=>j(parseFloat(e.target.value)||0),required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Maximum Members"}),(0,r.jsx)("input",{type:"number",min:"2",max:"10",className:"w-full bg-gray-700 border border-gray-600 rounded-md p-2.5",value:y,onChange:e=>N(parseInt(e.target.value)||2),required:!0})]})]}),(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4",children:[(0,r.jsxs)("h3",{className:"font-medium mb-2 flex items-center",children:[(0,r.jsx)(u.A,{size:16,className:"mr-2 text-gray-400"}),"Cost Breakdown"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Total Cost"}),(0,r.jsxs)("p",{className:"font-semibold",children:["$",f.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Your Share"}),(0,r.jsxs)("p",{className:"font-semibold text-green-400",children:["$",_.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded p-3 flex items-center",children:[(0,r.jsxs)("div",{className:"w-16 h-16 rounded-full bg-green-900/30 flex items-center justify-center text-green-400 font-bold text-xl mr-3",children:[T,"%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold",children:"Save money by sharing"}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:["Each member saves $",(f-_).toFixed(2)," per month"]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium mb-4",children:"Account Credentials"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"These credentials will be securely encrypted and only used for subscription payments"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email / Username"}),(0,r.jsx)("input",{type:"text",className:"w-full bg-gray-700 border border-gray-600 rounded-md p-2.5",value:w.email,onChange:e=>P({...w,email:e.target.value}),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Password"}),(0,r.jsx)("input",{type:"password",className:"w-full bg-gray-700 border border-gray-600 rounded-md p-2.5",value:w.password,onChange:e=>P({...w,password:e.target.value}),required:!0})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>M(1),className:"bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-md transition duration-200",children:"Back"}),(0,r.jsx)("button",{type:"button",onClick:()=>{if(f<=0){I("Please enter a valid total cost");return}if(y<2){I("Pool capacity must be at least 2");return}if(""===w.email.trim()||""===w.password.trim()){I("Please provide valid credentials");return}I(null),M(3)},className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",children:"Review Pool"})]})]})]}),3===U&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Review and create your pool"}),(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 mb-6",children:[(0,r.jsx)("div",{className:"h-2 rounded-t-lg mb-6",style:{backgroundColor:s?.color||"#6d28d9"}}),(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"h-16 w-16 relative rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",children:(0,r.jsx)(i.default,{src:s?.logo||"/assets/logos/default.svg",alt:s?.name||"Custom Service",layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:s?.name||"Custom Service"}),l&&"custom"!==l&&s?.plans&&(0,r.jsx)("p",{className:"text-gray-400",children:s.plans.find(e=>e.id===l)?.name}),"custom"===l&&b&&(0,r.jsx)("p",{className:"text-gray-400",children:b})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm text-gray-400 mb-1",children:"Subscription Details"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Total Cost"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",f.toFixed(2),"/month"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Maximum Members"}),(0,r.jsx)("span",{className:"font-medium",children:y})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Cost Per Member"}),(0,r.jsxs)("span",{className:"font-medium text-green-400",children:["$",_.toFixed(2),"/month"]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm text-gray-400 mb-1",children:"Savings"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 flex items-center",children:[(0,r.jsxs)("div",{className:"w-16 h-16 rounded-full bg-green-900/30 flex items-center justify-center text-green-400 font-bold text-xl mr-3",children:[T,"%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Each member saves"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-green-400",children:["$",(f-_).toFixed(2)," per month"]})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm text-gray-400 mb-1",children:"Account Information"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)("span",{className:"text-gray-400 mr-2",children:"Login Email:"}),(0,r.jsx)("span",{className:"font-medium",children:w.email})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-gray-400 mr-2",children:"Password:"}),(0,r.jsx)("span",{className:"font-medium",children:"••••••••••"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-700/30 rounded-lg p-4 mb-6 text-sm text-gray-300",children:[(0,r.jsx)("p",{children:"By creating this pool, you agree to the following:"}),(0,r.jsxs)("ul",{className:"list-disc ml-5 mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"You are authorized to share this subscription with others"}),(0,r.jsx)("li",{children:"You will ensure all members follow the service's terms of service"}),(0,r.jsx)("li",{children:"SubSplitter will handle recurring payments from all pool members"}),(0,r.jsx)("li",{children:"You are responsible for maintaining valid payment information"})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>M(2),className:"bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-md transition duration-200",children:"Back"}),(0,r.jsx)("button",{type:"submit",disabled:$,className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md flex items-center transition duration-200 disabled:bg-purple-900 disabled:cursor-not-allowed",children:$?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{size:18,className:"animate-spin mr-2"}),"Creating Pool..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.A,{size:18,className:"mr-2"}),"Create Pool"]})})]})]})]})]})]})}},5402:(e,s,t)=>{"use strict";t.d(s,{U:()=>a});class r{constructor(){this.apiUrl=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api",this.serviceCache=new Map}async getUserPools(){try{let e=await fetch("/api/auth");if(!e.ok)throw Error("Failed to get authentication token");let{accessToken:s}=await e.json(),t=await fetch(`${this.apiUrl}/pool-members/current-user`,{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw Error(`API error: ${t.status}`);let r=await t.json();return console.log("User Pools Data:",r),r.map(e=>({poolId:e.poolId,name:e.name||"Subscription Pool",serviceId:e.serviceId,slotsTotal:e.slotsTotal,slotsAvailable:e.slotsAvailable,costPerSlot:e.costPerSlot,membershipStatus:{paymentStatus:"paid",accessStatus:e.isActive?"active":"inactive",joinedAt:e.createdAt}}))}catch(e){return console.error("Error fetching user pools:",e),[]}}async getServiceInfo(e){if(this.serviceCache.has(e))return this.serviceCache.get(e);try{let s=await fetch(`${this.apiUrl}/subscription-services/${e}`);if(!s.ok)throw Error(`API error: ${s.status}`);let t=await s.json(),r={id:e,name:t.name||"Subscription Service",logoUrl:t.logoUrl||"/assets/logos/default.svg",color:t.color||"#6366f1"};return this.serviceCache.set(e,r),r}catch(s){return console.error(`Error fetching service ${e}:`,s),{id:e,name:"Subscription Service",logoUrl:"/assets/logos/default.svg",color:"#6366f1"}}}async getAllPools(){try{let e=await fetch(`${this.apiUrl}/subscriptions`);if(!e.ok)throw Error(`API error: ${e.status}`);let s=await e.json();if(console.log("API Data:",s),!s||0===s.length)return console.log("No pools returned from API"),[];return await this.transformPools(s)}catch(e){throw console.error("Error fetching pools:",e),e}}async createPool(e){try{let s=await fetch("/api/auth");if(!s.ok)throw Error("Failed to get authentication token");let{accessToken:t}=await s.json();if(!t)throw Error("Authentication token not found");let r={serviceId:e.serviceId,name:e.name,encryptedCredentials:e.encryptedCredentials,slotsTotal:e.slotsTotal,costPerSlot:e.costPerSlot.toString(),isActive:!0,region:null},a=await fetch(`${this.apiUrl}/subscriptions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(r)});if(!a.ok)throw Error(`API error: ${a.status}`);let l=await a.json();return console.log("Create Pool Response:",l),(await this.transformPools([l]))[0]}catch(e){throw console.error("Error creating pool:",e),e}}async joinPool(e){try{let s=await fetch("/api/auth");if(!s.ok)throw Error("Failed to get authentication token");let{accessToken:t}=await s.json(),r=await fetch(`${this.apiUrl}/subscriptions/${e}/join`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!r.ok){let e=await r.json();if(e.message&&e.message.includes("already a member"))throw Error("You have already joined this subscription pool");throw Error(`API error: ${r.status}`)}}catch(e){throw console.error("Error joining pool:",e),e}}async leavePool(e){try{let s=await fetch("/api/auth");if(!s.ok)throw Error("Failed to get authentication token");let{accessToken:t}=await s.json(),r=await fetch(`${this.apiUrl}/subscriptions/${e}/leave`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!r.ok)throw Error(`API error: ${r.status}`)}catch(e){throw console.error("Error leaving pool:",e),e}}async transformPools(e){let s=e.map(e=>this.getServiceInfo(e.serviceId)),t=await Promise.all(s),r=new Map;return t.forEach(e=>r.set(e.id,e)),e.map(e=>{let s=new Date,t=new Date(s);t.setMonth(s.getMonth()+1);let a={id:e.userId,name:"Pool Creator",isPrimary:!0},l=r.get(e.serviceId)||{id:e.serviceId,name:e.name||"Subscription Service",logoUrl:"/assets/logos/default.svg",color:"#6366f1"};return{id:e.poolId,serviceName:l.name,serviceLogo:l.logoUrl,serviceColor:l.color,plan:"Standard Plan",totalCost:parseFloat(e.costPerSlot)*e.slotsTotal,splitCost:parseFloat(e.costPerSlot),members:[a],capacity:e.slotsTotal,slotsAvailable:e.slotsAvailable,expiresAt:t.toISOString(),status:e.isActive?"active":"expired",lastPayment:e.updatedAt}})}}let a=new r},5315:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"X:\\\\Web Devlopment\\\\SubSplitter\\\\Frontend\\\\src\\\\app\\\\pools\\\\create-pool\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"X:\\Web Devlopment\\SubSplitter\\Frontend\\src\\app\\pools\\create-pool\\page.tsx","default")}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[638,263,433,163,441],()=>t(821));module.exports=r})();