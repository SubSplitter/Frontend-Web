"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[556],{3556:(e,s,l)=>{l.d(s,{A:()=>g});var t=l(5155),r=l(2115),a=l(5565),i=l(2823),n=l(7568),o=l(767),c=l(4505),d=l(8867),x=l(8617),m=l(3950);function u(e){let{poolId:s,poolName:l,costPerMonth:a,isOpen:i,onClose:u,onSuccess:h}=e,[g,b]=(0,r.useState)("idle"),[j,p]=(0,r.useState)(""),y=async()=>{try{b("loading"),await n.U.joinPool(s),b("success"),setTimeout(()=>{h(),u()},1500)}catch(e){console.error("Error joining pool:",e),e.message&&e.message.toLowerCase().includes("already a member")?b("already-joined"):(p(e.message||"Failed to join pool. Please try again later."),b("error"))}};return i?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-gray-800 rounded-xl max-w-md w-full overflow-hidden shadow-xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"already-joined"===g?"Already a Member":"Join Subscription Pool"}),(0,t.jsx)("button",{onClick:u,className:"text-gray-400 hover:text-white",disabled:"loading"===g,children:(0,t.jsx)(o.A,{size:20})})]}),(0,t.jsxs)("div",{className:"p-6",children:["idle"===g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"mb-4",children:["You're about to join the ",(0,t.jsx)("span",{className:"font-medium",children:l})," subscription pool."]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Your monthly cost:"}),(0,t.jsxs)("span",{className:"text-lg font-bold text-green-400",children:["$",a.toFixed(2)]})]}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"You'll be charged when the subscription renews. You can leave the pool anytime before the renewal date."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:u,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:y,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors",children:"Join Pool"})]})]}),"loading"===g&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)(c.A,{size:36,className:"animate-spin mx-auto text-purple-500 mb-4"}),(0,t.jsx)("p",{children:"Joining pool..."}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"This will only take a moment"})]}),"success"===g&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(d.A,{size:32,className:"text-green-400"})}),(0,t.jsx)("h4",{className:"text-xl font-semibold mb-2",children:"Successfully Joined!"}),(0,t.jsxs)("p",{className:"text-gray-400",children:["You are now a member of the ",l," pool"]})]}),"already-joined"===g&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(x.A,{size:32,className:"text-blue-400"})}),(0,t.jsx)("h4",{className:"text-xl font-semibold mb-2 text-blue-400",children:"Already a Member"}),(0,t.jsxs)("p",{className:"text-gray-400 mb-4",children:["You're already a member of this subscription pool.",(0,t.jsx)("br",{}),(0,t.jsxs)("span",{className:"block mt-2",children:["Check your active memberships to access ",l,"."]})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("button",{onClick:u,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"Got It"})})]}),"error"===g&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(m.A,{size:32,className:"text-red-400"})}),(0,t.jsx)("h4",{className:"text-xl font-semibold mb-2 text-red-400",children:"Error"}),(0,t.jsx)("p",{className:"text-gray-400 mb-4",children:j}),(0,t.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,t.jsx)("button",{onClick:u,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{b("idle"),p("")},className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors",children:"Try Again"})]})]})]})]})}):null}function h(e){let{poolId:s,poolName:l,isOpen:a,onClose:i,onSuccess:n}=e,[x,u]=(0,r.useState)("idle"),[h,g]=(0,r.useState)(""),b=async()=>{try{u("loading"),n(),u("success"),setTimeout(()=>{i()},1500)}catch(e){console.error("Error leaving pool:",e),g(e.message||"Failed to leave pool. Please try again later."),u("error")}};return a?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-gray-800 rounded-xl max-w-md w-full overflow-hidden shadow-xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Leave Subscription Pool"}),(0,t.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-white",disabled:"loading"===x,children:(0,t.jsx)(o.A,{size:20})})]}),(0,t.jsxs)("div",{className:"p-6",children:["idle"===x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"mb-4",children:["Are you sure you want to leave the ",(0,t.jsx)("span",{className:"font-medium",children:l})," subscription pool?"]}),(0,t.jsx)("div",{className:"bg-gray-900 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,t.jsx)("p",{children:"When you leave a pool:"}),(0,t.jsxs)("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[(0,t.jsx)("li",{children:"You'll lose access to the subscription immediately"}),(0,t.jsx)("li",{children:"You won't be charged in future billing cycles"}),(0,t.jsx)("li",{children:"No refunds are provided for the current billing period"})]})]})}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:b,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Leave Pool"})]})]}),"loading"===x&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)(c.A,{size:36,className:"animate-spin mx-auto text-purple-500 mb-4"}),(0,t.jsx)("p",{children:"Processing your request..."}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"This will only take a moment"})]}),"success"===x&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(d.A,{size:32,className:"text-green-400"})}),(0,t.jsx)("h4",{className:"text-xl font-semibold mb-2",children:"Successfully Left Pool"}),(0,t.jsxs)("p",{className:"text-gray-400",children:["You've been removed from the ",l," pool"]})]}),"error"===x&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(m.A,{size:32,className:"text-red-400"})}),(0,t.jsx)("h4",{className:"text-xl font-semibold mb-2 text-red-400",children:"Error"}),(0,t.jsx)("p",{className:"text-gray-400 mb-4",children:h}),(0,t.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,t.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{u("idle"),g("")},className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Try Again"})]})]})]})]})}):null}function g(e){let{pool:s,onClick:l,onJoin:n,onLeave:o,currentUserId:c}=e,[d,x]=(0,r.useState)(!1),[m,g]=(0,r.useState)(!1),b=s.slotsAvailable,j=new Date(s.expiresAt).toLocaleDateString(),p=(s.totalCost/s.capacity*(s.capacity-1)/s.totalCost*100).toFixed(0),y=s.isUserMember||s.members.some(e=>e.id===c);return console.log("Pool:",s.serviceName,"- isUserMember:",y),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-gray-800 rounded-xl overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-4px] cursor-pointer border border-gray-700",onClick:l,children:[(0,t.jsx)("div",{className:"h-1",style:{backgroundColor:s.serviceColor}}),(0,t.jsxs)("div",{className:"p-5",children:[(0,t.jsxs)("div",{className:"flex items-center mb-5",children:[(0,t.jsx)("div",{className:"h-12 w-12 relative rounded-lg overflow-hidden bg-gray-900",children:(0,t.jsx)(a.default,{src:s.serviceLogo,alt:s.serviceName,layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsx)("h3",{className:"text-lg font-bold",children:s.serviceName}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("p",{className:"text-gray-400 text-xs",children:["Renews on ",j]}),(0,t.jsxs)("div",{className:"bg-green-900/30 text-green-400 text-xs px-2 py-1 rounded-full",children:["Save ",p,"%"]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-5 bg-gray-900 rounded-lg p-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-400",children:"Total"}),(0,t.jsxs)("div",{className:"text-lg font-bold",children:["$",s.totalCost.toFixed(2)]})]}),(0,t.jsx)("div",{className:"text-gray-400",children:(0,t.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M5 12H19M19 12L13 6M19 12L13 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-400",children:"Your share"}),(0,t.jsxs)("div",{className:"text-lg font-bold text-green-400",children:["$",s.splitCost.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-300",children:[(0,t.jsx)(i.A,{size:14,className:"inline mr-1 text-gray-400"}),"Members"]}),(0,t.jsxs)("div",{className:"text-sm bg-gray-700 px-2 py-1 rounded-full",children:[s.capacity-s.slotsAvailable,"/",s.capacity]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-1.5",children:(0,t.jsx)("div",{className:"bg-purple-600 h-1.5 rounded-full",style:{width:"".concat((s.capacity-s.slotsAvailable)/s.capacity*100,"%")}})})]}),y?(0,t.jsx)("button",{className:"w-full py-2.5 px-4 rounded-lg font-medium flex items-center justify-center transition duration-200 bg-gray-700 hover:bg-gray-600 text-white",onClick:e=>{e.stopPropagation(),g(!0)},children:"Leave Pool"}):(0,t.jsx)("button",{className:"w-full py-2.5 px-4 rounded-lg font-medium flex items-center justify-center transition duration-200 ".concat(b>0?"bg-purple-600 hover:bg-purple-700 text-white":"bg-gray-700 text-gray-400 cursor-not-allowed"),disabled:0===b,onClick:e=>{e.stopPropagation(),x(!0)},children:b>0?"Join Pool (".concat(b," ").concat(1===b?"spot":"spots"," left)"):"Pool is Full"})]})]}),(0,t.jsx)(u,{poolId:s.id,poolName:s.serviceName,costPerMonth:s.splitCost,isOpen:d,onClose:()=>x(!1),onSuccess:()=>{n&&n()}}),(0,t.jsx)(h,{poolId:s.id,poolName:s.serviceName,isOpen:m,onClose:()=>g(!1),onSuccess:()=>{o&&o()}})]})}}}]);