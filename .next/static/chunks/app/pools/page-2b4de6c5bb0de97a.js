(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[593],{3543:(e,t,s)=>{Promise.resolve().then(s.bind(s,2143))},8867:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(7401).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},8617:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(7401).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},4505:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(7401).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3473:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(7401).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3950:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(7401).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2143:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var l=s(5155),r=s(2115),a=s(6793),o=s.n(a),i=s(2722),n=s(3556),c=s(3473),d=s(853),p=s(8236);let x=(0,s(7401).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var u=s(2823),m=s(7568),h=s(6046);let g={sortBy:["Recently Updated","Price: Low to High","Price: High to Low","Expiring Soon"]};function y(){let e=(0,h.useSearchParams)(),t=(0,h.useRouter)(),[s,a]=(0,r.useState)([]),[o,i]=(0,r.useState)(!0),[y,f]=(0,r.useState)(null),[b,j]=(0,r.useState)(""),[N,v]=(0,r.useState)("All"),[w,A]=(0,r.useState)("Recently Updated"),[k,C]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let t=e.get("service");t&&j(t)},[e]),(0,r.useEffect)(()=>{(async()=>{try{i(!0);let e=await m.U.getAllPools();a(e)}catch(e){console.error("Error fetching pools:",e),f("Failed to load subscription pools. Please try again later.")}finally{i(!1)}})()},[]);let P=async e=>{try{i(!0);let e=await m.U.getAllPools();a(e),i(!1)}catch(e){console.error("Error refreshing pools:",e),f("Failed to refresh pool list. Please reload the page."),i(!1)}},S=()=>{window.location.href="/pools/create-pool"},E=async e=>{try{i(!0),await m.U.leavePool(e);let t=await m.U.getAllPools();a(t),i(!1)}catch(e){console.error("Error leaving pool:",e),f("Failed to leave pool. Please try again later."),i(!1)}},z=()=>"1",L=[...s.filter(e=>{let t=e.serviceName.toLowerCase().includes(b.toLowerCase()),s="All"===N||e.status===N.toLowerCase(),l=z(),r=!k||e.members.some(e=>e.id===l);return t&&s&&r})].sort((e,t)=>"Price: Low to High"===w?e.splitCost-t.splitCost:"Price: High to Low"===w?t.splitCost-e.splitCost:"Expiring Soon"===w?new Date(e.expiresAt).getTime()-new Date(t.expiresAt).getTime():new Date(t.lastPayment||t.expiresAt).getTime()-new Date(e.lastPayment||e.expiresAt).getTime());return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-1",children:"Subscription Pools"}),(0,l.jsx)("p",{className:"text-gray-400",children:"Manage your shared subscriptions"})]}),(0,l.jsxs)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md flex items-center justify-center transition duration-200",onClick:S,children:[(0,l.jsx)(c.A,{size:18,className:"mr-2"}),"Create New Pool"]})]}),(0,l.jsx)("div",{className:"bg-gray-800 rounded-xl p-4 mb-8",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"relative flex-1",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search pools...",className:"w-full bg-gray-700 text-gray-200 rounded-md py-2 pl-10 pr-4 focus:outline-none focus:ring-1 focus:ring-purple-500",value:b,onChange:e=>j(e.target.value)}),(0,l.jsx)(d.A,{size:18,className:"absolute left-3 top-2.5 text-gray-400"})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,l.jsx)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",onClick:()=>{j(""),v("All"),C(!1);let e=window.location.pathname;t.push(e)},children:"Clear Filters"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("select",{className:"appearance-none bg-gray-700 text-gray-200 rounded-md py-2 pl-10 pr-8 focus:outline-none focus:ring-1 focus:ring-purple-500",value:w,onChange:e=>A(e.target.value),children:g.sortBy.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(p.A,{size:18,className:"absolute left-3 top-2.5 text-gray-400"}),(0,l.jsx)("div",{className:"absolute right-2 top-2.5 pointer-events-none text-gray-400",children:(0,l.jsx)(x,{size:16})})]})]})]})}),o&&(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl p-8 text-center",children:[(0,l.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4 animate-pulse",children:(0,l.jsx)(u.A,{size:24,className:"text-gray-500"})}),(0,l.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Loading pools..."})]}),y&&(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl p-8 text-center",children:[(0,l.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)(u.A,{size:24,className:"text-gray-500"})}),(0,l.jsx)("h3",{className:"text-xl font-semibold mb-2 text-red-400",children:"Error"}),(0,l.jsx)("p",{className:"text-gray-400 mb-4",children:y}),(0,l.jsx)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",onClick:()=>{f(null),i(!0),m.U.getAllPools().then(e=>{a(e),i(!1)}).catch(e=>{console.error("Error retrying pools fetch:",e),f("Failed to load subscription pools. Please try again later."),i(!1)})},children:"Retry"})]}),!o&&!y&&L.length>0&&(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:L.map(e=>(0,l.jsx)(n.A,{pool:e,onJoin:()=>P(e.id),onLeave:()=>E(e.id),currentUserId:z(),onClick:()=>{window.location.href="/pools/".concat(e.id)}},e.id))}),!o&&!y&&0===L.length&&(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl p-8 text-center",children:[(0,l.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)(u.A,{size:24,className:"text-gray-500"})}),(0,l.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No pools found"}),(0,l.jsx)("p",{className:"text-gray-400 mb-4",children:b||"All"!==N||!k?"Try adjusting your search or filters":"Start by creating a new subscription pool or joining an existing one"}),b||"All"!==N||!k?(0,l.jsx)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",onClick:()=>{j(""),v("All"),C(!0)},children:"Clear Filters"}):(0,l.jsxs)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md flex items-center justify-center transition duration-200 mx-auto",onClick:S,children:[(0,l.jsx)(c.A,{size:18,className:"mr-2"}),"Create New Pool"]})]})]})}let f=()=>(0,l.jsxs)(i.A,{children:[(0,l.jsx)(o(),{children:(0,l.jsx)("title",{children:"Subscription Pools | SubSplitter"})}),(0,l.jsx)(r.Suspense,{fallback:(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl p-8 text-center",children:[(0,l.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4 animate-pulse",children:(0,l.jsx)(u.A,{size:24,className:"text-gray-500"})}),(0,l.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Loading pools..."})]}),children:(0,l.jsx)(y,{})})]})}},e=>{var t=t=>e(e.s=t);e.O(0,[407,291,921,600,85,556,441,517,358],()=>t(3543)),_N_E=e.O()}]);