(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[884],{8856:(e,s,l)=>{Promise.resolve().then(l.bind(l,5483))},8867:(e,s,l)=>{"use strict";l.d(s,{A:()=>r});let r=(0,l(7401).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},8617:(e,s,l)=>{"use strict";l.d(s,{A:()=>r});let r=(0,l(7401).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},4505:(e,s,l)=>{"use strict";l.d(s,{A:()=>r});let r=(0,l(7401).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3473:(e,s,l)=>{"use strict";l.d(s,{A:()=>r});let r=(0,l(7401).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5483:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>b});var r=l(5155),a=l(2115),t=l(6793),i=l.n(t),n=l(5565),d=l(2722);let c=(0,l(7401).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var o=l(8867),m=l(4505),x=l(3473),u=l(8617),h=l(6046),p=l(7568),g=l(2818);let b=()=>{var e,s;let l=(0,h.useRouter)(),[t,b]=(0,a.useState)(null),[j,v]=(0,a.useState)(""),[y,f]=(0,a.useState)(""),[N,w]=(0,a.useState)(0),[C,S]=(0,a.useState)(2),[k,P]=(0,a.useState)({email:"",password:""}),[F,A]=(0,a.useState)([]),[E,M]=(0,a.useState)(!0),[z,$]=(0,a.useState)(!1),[_,I]=(0,a.useState)(null),[B,L]=(0,a.useState)(1),T=C>0?parseFloat((N/C).toFixed(2)):0,U=C>1?Math.round((N-T)/N*100):0;(0,a.useEffect)(()=>{(async()=>{try{M(!0);let e=await fetch("".concat(g.env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api","/subscription-services"));if(!e.ok)throw Error("Failed to fetch services: ".concat(e.status));let s=(await e.json()).map(e=>({id:e.serviceId,name:e.name,logo:e.logoUrl||"/assets/logos/default.svg",color:e.color||"#6366f1",plans:e.plans?e.plans.map(e=>({id:e.planId,name:e.name,price:parseFloat(e.price)})):[]}));A(s)}catch(e){console.error("Error fetching services:",e),I("Failed to load available services. Please try again later.")}finally{M(!1)}})()},[]);let R=e=>{b(e),v(""),f(""),w(0),e.plans&&0!==e.plans.length||L(2)},q=(e,s)=>{v(e),w(s),L(2)},Y=async e=>{if(e.preventDefault(),!t){I("Please select a service");return}if(N<=0){I("Please enter a valid total cost");return}if(C<2){I("Pool capacity must be at least 2");return}if(""===k.email.trim()||""===k.password.trim()){I("Please provide valid credentials");return}try{$(!0),I(null);let e=JSON.stringify(k),s={serviceId:t.id,name:t.name+("custom"===j?" (".concat(y,")"):""),encryptedCredentials:e,slotsTotal:C,costPerSlot:T};await p.U.createPool(s),l.push("/pools")}catch(e){console.error("Error creating pool:",e),I("Failed to create pool. Please try again later."),$(!1)}};return(0,r.jsxs)(d.A,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Create Subscription Pool | SubSplitter"})}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("button",{onClick:()=>l.push("/pools"),className:"text-gray-400 hover:text-white flex items-center mb-4",children:[(0,r.jsx)(c,{size:18,className:"mr-2"}),"Back to Pools"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold mb-1",children:"Create New Subscription Pool"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Split the cost of your subscription with others"})]}),(0,r.jsxs)("div",{className:"flex mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center ".concat(B>=1?"text-purple-500":"text-gray-500"),children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full mr-2 ".concat(B>=1?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"),children:B>1?(0,r.jsx)(o.A,{size:16}):1}),(0,r.jsx)("span",{className:"mr-4",children:"Select Service"})]}),(0,r.jsx)("div",{className:"h-0.5 flex-grow my-auto mx-2 ".concat(B>=2?"bg-purple-500":"bg-gray-700")}),(0,r.jsxs)("div",{className:"flex items-center ".concat(B>=2?"text-purple-500":"text-gray-500"),children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full mr-2 ".concat(B>=2?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"),children:B>2?(0,r.jsx)(o.A,{size:16}):2}),(0,r.jsx)("span",{className:"mr-4",children:"Configure Pool"})]}),(0,r.jsx)("div",{className:"h-0.5 flex-grow my-auto mx-2 ".concat(B>=3?"bg-purple-500":"bg-gray-700")}),(0,r.jsxs)("div",{className:"flex items-center ".concat(B>=3?"text-purple-500":"text-gray-500"),children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full mr-2 ".concat(B>=3?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"),children:"3"}),(0,r.jsx)("span",{children:"Review & Create"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6",children:[E&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(m.A,{size:36,className:"animate-spin mx-auto text-purple-500 mb-4"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Loading available services..."})]}),_&&(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 mb-6 text-red-400",children:(0,r.jsx)("p",{children:_})}),!E&&(0,r.jsxs)("form",{onSubmit:Y,children:[1===B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Select a subscription service"}),0===F.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-400",children:(0,r.jsx)("p",{children:"No services available. Please try again later."})}):(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[F.map(e=>(0,r.jsx)("div",{onClick:()=>R(e),className:"p-4 rounded-lg cursor-pointer transition-all border ".concat((null==t?void 0:t.id)===e.id?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50 hover:bg-gray-700"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-12 w-12 relative rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",children:(0,r.jsx)(n.default,{src:e.logo,alt:e.name,layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("h3",{className:"font-medium",children:e.name})})]})},e.id)),(0,r.jsxs)("div",{onClick:()=>{b({id:"custom",name:"Custom Service",logo:"/assets/logos/default.svg",color:"#6d28d9"}),L(2)},className:"p-4 rounded-lg cursor-pointer transition-all border ".concat((null==t?void 0:t.id)==="custom"?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50 hover:bg-gray-700"," flex items-center justify-center"),children:[(0,r.jsx)(x.A,{size:20,className:"mr-2 text-purple-500"}),(0,r.jsx)("span",{children:"Custom Service"})]})]}),t&&t.plans&&t.plans.length>0&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium mb-4",children:["Select a plan for ",t.name]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[t.plans.map(e=>(0,r.jsxs)("div",{onClick:()=>q(e.id,e.price),className:"p-4 rounded-lg cursor-pointer transition-all border ".concat(j===e.id?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50 hover:bg-gray-700"),children:[(0,r.jsx)("h4",{className:"font-medium mb-1",children:e.name}),(0,r.jsxs)("p",{className:"text-gray-400",children:["$",e.price.toFixed(2),"/month"]})]},e.id)),(0,r.jsxs)("div",{className:"p-4 rounded-lg transition-all border ".concat("custom"===j?"border-purple-500 bg-purple-900/20":"border-gray-700 bg-gray-700/50"),children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Custom Plan"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Plan name",className:"w-full bg-gray-900 border border-gray-700 rounded p-2 text-sm",value:y,onChange:e=>f(e.target.value)}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"$"}),(0,r.jsx)("input",{type:"number",min:"0.01",step:"0.01",placeholder:"Monthly cost",className:"flex-1 bg-gray-900 border border-gray-700 rounded p-2 text-sm",value:N||"",onChange:e=>w(parseFloat(e.target.value)||0)}),(0,r.jsx)("span",{className:"ml-1",children:"/month"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{if(""===y.trim()||N<=0){I("Please provide a valid plan name and cost");return}v("custom"),L(2),I(null)},className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-1 px-3 rounded text-sm transition duration-200",children:"Use Custom Plan"})]})]})]})]}),t&&(!t.plans||0===t.plans.length)&&(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{type:"button",onClick:()=>L(2),className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",children:"Continue"})})]}),2===B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Configure your subscription pool"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"h-12 w-12 relative rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",style:{backgroundColor:(null==t?void 0:t.color)||"#374151"},children:(0,r.jsx)(n.default,{src:(null==t?void 0:t.logo)||"/assets/logos/default.svg",alt:(null==t?void 0:t.name)||"Custom Service",layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"font-medium",children:(null==t?void 0:t.name)||"Custom Service"}),j&&"custom"!==j&&(null==t?void 0:t.plans)&&(0,r.jsx)("p",{className:"text-sm text-gray-400",children:null===(e=t.plans.find(e=>e.id===j))||void 0===e?void 0:e.name}),"custom"===j&&(0,r.jsx)("p",{className:"text-sm text-gray-400",children:y})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Total Monthly Cost"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2 text-gray-400",children:"$"}),(0,r.jsx)("input",{type:"number",min:"0.01",step:"0.01",placeholder:"0.00",className:"flex-1 bg-gray-700 border border-gray-600 rounded-md p-2.5",value:N||"",onChange:e=>w(parseFloat(e.target.value)||0),required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Maximum Members"}),(0,r.jsx)("input",{type:"number",min:"2",max:"10",className:"w-full bg-gray-700 border border-gray-600 rounded-md p-2.5",value:C,onChange:e=>S(parseInt(e.target.value)||2),required:!0})]})]}),(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4",children:[(0,r.jsxs)("h3",{className:"font-medium mb-2 flex items-center",children:[(0,r.jsx)(u.A,{size:16,className:"mr-2 text-gray-400"}),"Cost Breakdown"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Total Cost"}),(0,r.jsxs)("p",{className:"font-semibold",children:["$",N.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Your Share"}),(0,r.jsxs)("p",{className:"font-semibold text-green-400",children:["$",T.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded p-3 flex items-center",children:[(0,r.jsxs)("div",{className:"w-16 h-16 rounded-full bg-green-900/30 flex items-center justify-center text-green-400 font-bold text-xl mr-3",children:[U,"%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold",children:"Save money by sharing"}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:["Each member saves $",(N-T).toFixed(2)," per month"]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium mb-4",children:"Account Credentials"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"These credentials will be securely encrypted and only used for subscription payments"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email / Username"}),(0,r.jsx)("input",{type:"text",className:"w-full bg-gray-700 border border-gray-600 rounded-md p-2.5",value:k.email,onChange:e=>P({...k,email:e.target.value}),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Password"}),(0,r.jsx)("input",{type:"password",className:"w-full bg-gray-700 border border-gray-600 rounded-md p-2.5",value:k.password,onChange:e=>P({...k,password:e.target.value}),required:!0})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>L(1),className:"bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-md transition duration-200",children:"Back"}),(0,r.jsx)("button",{type:"button",onClick:()=>{if(N<=0){I("Please enter a valid total cost");return}if(C<2){I("Pool capacity must be at least 2");return}if(""===k.email.trim()||""===k.password.trim()){I("Please provide valid credentials");return}I(null),L(3)},className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition duration-200",children:"Review Pool"})]})]})]}),3===B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Review and create your pool"}),(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 mb-6",children:[(0,r.jsx)("div",{className:"h-2 rounded-t-lg mb-6",style:{backgroundColor:(null==t?void 0:t.color)||"#6d28d9"}}),(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"h-16 w-16 relative rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",children:(0,r.jsx)(n.default,{src:(null==t?void 0:t.logo)||"/assets/logos/default.svg",alt:(null==t?void 0:t.name)||"Custom Service",layout:"fill",objectFit:"cover",onError:e=>{let s=e.target;s.onerror=null,s.src="/assets/logos/default.svg"}})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:(null==t?void 0:t.name)||"Custom Service"}),j&&"custom"!==j&&(null==t?void 0:t.plans)&&(0,r.jsx)("p",{className:"text-gray-400",children:null===(s=t.plans.find(e=>e.id===j))||void 0===s?void 0:s.name}),"custom"===j&&y&&(0,r.jsx)("p",{className:"text-gray-400",children:y})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm text-gray-400 mb-1",children:"Subscription Details"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Total Cost"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",N.toFixed(2),"/month"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Maximum Members"}),(0,r.jsx)("span",{className:"font-medium",children:C})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Cost Per Member"}),(0,r.jsxs)("span",{className:"font-medium text-green-400",children:["$",T.toFixed(2),"/month"]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm text-gray-400 mb-1",children:"Savings"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 flex items-center",children:[(0,r.jsxs)("div",{className:"w-16 h-16 rounded-full bg-green-900/30 flex items-center justify-center text-green-400 font-bold text-xl mr-3",children:[U,"%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Each member saves"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-green-400",children:["$",(N-T).toFixed(2)," per month"]})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm text-gray-400 mb-1",children:"Account Information"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)("span",{className:"text-gray-400 mr-2",children:"Login Email:"}),(0,r.jsx)("span",{className:"font-medium",children:k.email})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-gray-400 mr-2",children:"Password:"}),(0,r.jsx)("span",{className:"font-medium",children:"••••••••••"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-700/30 rounded-lg p-4 mb-6 text-sm text-gray-300",children:[(0,r.jsx)("p",{children:"By creating this pool, you agree to the following:"}),(0,r.jsxs)("ul",{className:"list-disc ml-5 mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"You are authorized to share this subscription with others"}),(0,r.jsx)("li",{children:"You will ensure all members follow the service's terms of service"}),(0,r.jsx)("li",{children:"SubSplitter will handle recurring payments from all pool members"}),(0,r.jsx)("li",{children:"You are responsible for maintaining valid payment information"})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>L(2),className:"bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-md transition duration-200",children:"Back"}),(0,r.jsx)("button",{type:"submit",disabled:z,className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md flex items-center transition duration-200 disabled:bg-purple-900 disabled:cursor-not-allowed",children:z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{size:18,className:"animate-spin mr-2"}),"Creating Pool..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{size:18,className:"mr-2"}),"Create Pool"]})})]})]})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[407,291,921,600,85,441,517,358],()=>s(8856)),_N_E=e.O()}]);